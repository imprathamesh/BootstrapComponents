@using System.Globalization

<div class="position-relative">

    <input class="form-control"
           readonly
           value="@SelectedDates(Format(StartDate), Format(EndDate))"
           placeholder="Select Date"
           @onclick="Toggle" @attributes="AdditionalAttributes" />

    @if (IsOpen)
    {
        <div class="card shadow position-absolute mt-2 z-3" style="max-width:50rem">
            <div class="card-body">
                <div class="row">
                    <!-- Presets -->
                    <div class="col-3 border-end">
                        @foreach (var preset in DateRangePreset.List())
                        {
                            <button class="btn btn-sm w-100 text-start mb-1 btn-outline-secondary"
                                    @onclick="() => ApplyPreset(preset)">
                                @preset.Name
                            </button>
                        }
                    </div>

                    <!-- Calendars -->
                    <div class="col-9">

                        <!-- Header -->
                        <div class="d-flex justify-content-between align-items-center gap-3 mb-2">
                            <button class="btn  btn-sm btn-outline-secondary" @onclick="PrevMonth"><i class="bi bi chevron-left"></i></button>
                            <!-- Month dropdown -->
                            <select class="form-select form-select-sm"
                                    value="@CurrentMonth"
                                    @onchange="MonthOrYearChanged">
                                @for (int m = 1; m <= 12; m++)
                                {
                                    <option value="@m">
                                        @CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(m)
                                    </option>
                                }
                            </select>
                            <select class="form-select form-select-sm  "
                                    value="@CurrentYear" @onchange="YearChanged">
                                @for (int y = StartYear; y <= EndYear; y++)
                                {
                                    <option value="@y">@y</option>
                                }
                            </select>

                            <button class="btn btn-sm btn-outline-secondary" @onclick="NextMonth"><i class="bi bi chevron-right"></i></button>
                        </div>

                        <div class="row">
                            <div class="col">
                                @BuildCalendar(LeftMonth)
                            </div>

                            @if (TwoMonthView)
                            {
                                <div class="col">
                                    @BuildCalendar(RightMonth)
                                </div>
                            }
                        </div>
                        <div class="d-flex justify-content-end mt-2">
                            @*  <button class="btn btn-sm btn-outline-primary" @onclick="SelectToday">
                                Today
                            </button> *@
                            <button class="btn btn-sm btn-outline-secondary" @onclick="Clear">
                                Clear
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    }
</div>
